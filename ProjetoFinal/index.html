<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Projeto Final - AUREA Docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Projeto Final";
        var mkdocs_page_input_path = "ProjetoFinal.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> AUREA Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Projeto Final</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#0-sumario-executivo">0) Sum√°rio executivo</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1-objetivos-e-resultados">1) Objetivos e resultados</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-escopo">2) Escopo</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-arquitetura-enxuta">3) Arquitetura (enxuta)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#31-componentes">3.1 Componentes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#32-fluxo-de-alto-nivel">3.2 Fluxo de alto n√≠vel</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-contratos-de-dados">4) Contratos de dados</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#41-tipos-principais-rust-json-schema">4.1 Tipos principais (Rust ‚Üí JSON Schema)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#42-versionamento-e-interoperabilidade">4.2 Versionamento e interoperabilidade</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-api-e-protocolo">5) API e protocolo</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#51-http3-quic-e-sse">5.1 HTTP/3 (QUIC) e SSE</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#52-quic-workersout-of-proc">5.2 QUIC (workers/out-of-proc)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#6-policies-compile-time-auditaveis">6) Policies (compile-time, audit√°veis)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#7-vcx-pack-artefatos">7) VCX-PACK (artefatos)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#8-determinismo-e-reprodutibilidade">8) Determinismo e reprodutibilidade</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#9-observabilidade-e-forense">9) Observabilidade e forense</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#10-ui-pwa-axum-leptos">10) UI PWA (Axum + Leptos)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#11-seguranca-e-conformidade">11) Seguran√ßa e conformidade</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#12-roadmap-90-dias">12) Roadmap (90 dias)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#m1-fundacao-1-binario-d0d15">M1 ‚Äî Funda√ß√£o 1-bin√°rio (D0‚ÄìD15)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#m2-recibos-fortes-vcx-d16d35">M2 ‚Äî Recibos fortes + VCX (D16‚ÄìD35)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#m3-dominios-d36d65">M3 ‚Äî Dom√≠nios (D36‚ÄìD65)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#m4-operacao-critica-e-sre-d66d90">M4 ‚Äî Opera√ß√£o cr√≠tica e SRE (D66‚ÄìD90)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#13-criterios-de-aceite">13) Crit√©rios de aceite</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#14-riscos-mitigacoes">14) Riscos &amp; mitiga√ß√µes</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#15-implantacao-e-operacao">15) Implanta√ß√£o e opera√ß√£o</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#16-testes-e-validacao">16) Testes e valida√ß√£o</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#17-governanca-e-licenca">17) Governan√ßa e licen√ßa</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#18-entregaveis">18) Entreg√°veis</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#19-exemplo-de-contrato-e-handler">19) Exemplo de contrato e handler</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#20-plano-de-adocao">20) Plano de ado√ß√£o</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#pronto-para-construcao">Pronto para constru√ß√£o</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prompt">Prompt:</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#response">Response:</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#padrao-operador-conversacional-oc">Padr√£o: Operador Conversacional (OC)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#fases-de-fora-parece-um-chat-por-dentro-e-uma-esteira">Fases (de fora parece ‚Äúum chat‚Äù, por dentro √© uma esteira)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#como-isso-esconde-complexidade-com-seguranca">Como isso ‚Äúesconde‚Äù complexidade (com seguran√ßa)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#contratos-minimos-exemplos">Contratos m√≠nimos (exemplos)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ux-no-chat-uma-timeline-zero-atrito">UX no chat (uma timeline, zero atrito)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exemplos-por-dominio">Exemplos por dom√≠nio</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#vcx">VCX</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ciencia-reprodutivel">Ci√™ncia reprodut√≠vel</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#hdl">HDL</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#controles-que-mantem-tudo-livre-mas-seguro">Controles que mant√™m tudo ‚Äúlivre, mas seguro‚Äù</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#como-integrar-no-aurea-agora">Como integrar no √ÅUREA agora</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ganhos-praticos">Ganhos pr√°ticos</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prompt_1">Prompt:</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#response_1">Response:</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../charter/project_charter/">Charter</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../sow/statement_of_work/">SoW</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../prd/prd/">PRD</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/apis/">APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/oc_spec/">OC Spec</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/error_codes/">Errors</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UX</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ux/plan_card_spec/">PlanCard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ux/microcopy/">Microcopy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ux/checklist_pr10/">Checklist PR-10</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../security/security_privacy/">Security</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Runbook</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../runbook/operations/">Operations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runbook/incidents/">Incidents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runbook/backup_restore/">Backup/Restore</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../qa/strategy/">QA</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../qa/canon_fixtures/">QA Canon Fixtures</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../slo/slis_slos/">SLO</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Interop</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../interop/ro_crate_mapping/">Mapping</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interop/data_refs/">Data Refs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interop/ro_crate_examples/">Examples</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../governance/contributing/">Governance</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">AUREA Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Projeto Final</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="aurea-projeto-final">√ÅUREA ‚Äî Projeto Final</h1>
<p><strong>Plataforma 100% Rust para Ci√™ncia Reprodut√≠vel, VCX, Prot√≥tipos de Sil√≠cio e Opera√ß√£o Cr√≠tica</strong></p>
<hr />
<h2 id="0-sumario-executivo">0) Sum√°rio executivo</h2>
<p>√ÅUREA √© uma plataforma unificada, tipada e verific√°vel para execu√ß√£o de trabalhos cr√≠ticos com <strong>determinismo</strong>, <strong>recibos fortes</strong> e <strong>artefatos port√°veis</strong>. Implementada integralmente em Rust, combina um <strong>bus de jobs</strong> com <strong>pol√≠ticas audit√°veis</strong>, <strong>plugins nativos/WASI</strong>, empacotamento universal <strong>VCX-PACK</strong> e <strong>UI PWA</strong>. O desenho minimiza componentes e round-trips: <strong>um bin√°rio</strong> principal serve API+UI, gerencia fila/leases, assina recibos e exp√µe m√©tricas; workers rodam <strong>in-proc</strong> por padr√£o e <strong>out-of-proc</strong>/QUIC quando necess√°rio.</p>
<hr />
<h2 id="1-objetivos-e-resultados">1) Objetivos e resultados</h2>
<ul>
<li><strong>Determinismo e reprodutibilidade</strong>: replay bit-a-bit via seeds, clocks fixos, canonical JSON e KATs.</li>
<li><strong>Auditabilidade forte</strong>: recibos com NRF/CID, <code>policy_trace</code>, tempos por etapa e assinaturas ed25519.</li>
<li><strong>Tipagem ponta-a-ponta</strong>: contratos Rust ‚Üí JSON Schema ‚Üí valida√ß√£o de payloads/results ‚Üí UI auto-gerada.</li>
<li><strong>Opera√ß√£o cr√≠tica</strong>: quotas r√≠gidas, PII/local-only, janelas, DUAL_CONTROL, √¢ncoras Merkle.</li>
<li><strong>Portabilidade de artefatos</strong>: VCX-PACK com manifesto/√≠ndices/hashes/verify.</li>
<li><strong>TCO baixo</strong>: tudo Rust, sem SaaS de cola; um bin√°rio opera API, fila e observabilidade.</li>
</ul>
<hr />
<h2 id="2-escopo">2) Escopo</h2>
<p>Dom√≠nios de primeira classe:</p>
<ol>
<li><strong>Ci√™ncia reprodut√≠vel</strong> (WASI/bin, KATs).</li>
<li><strong>VCX</strong> (imagem/√°udio/v√≠deo, AV1, tempos por etapa).</li>
<li><strong>HDL</strong> (gera√ß√£o Rust‚ÜíHDL, simula√ß√£o determin√≠stica, VCD).</li>
<li><strong>Operadores sem√¢nticos</strong> (Text‚ÜíJSON schema-driven; RAG tipado).</li>
</ol>
<hr />
<h2 id="3-arquitetura-enxuta">3) Arquitetura (enxuta)</h2>
<h3 id="31-componentes">3.1 Componentes</h3>
<ul>
<li><strong>aurea-bin</strong> (√∫nico bin√°rio)<ul>
<li><strong>API/Bus</strong>: HTTP/3 (QUIC) + HTTP/1.1 fallback; SSE para stream.</li>
<li><strong>UI PWA</strong> (Axum + Leptos): forms e viewers gerados por schema.</li>
<li><strong>Fila/Leases</strong>: <code>redb</code> ACID; reassign autom√°tico.</li>
<li><strong>Policies</strong>: fun√ß√µes puras compiladas; <code>policy_trace</code> no recibo.</li>
<li><strong>Assinaturas</strong>: ed25519 (chaves geridas pelo servi√ßo; <code>kid</code> rotativo).</li>
<li><strong>Observabilidade</strong>: Prometheus + exports Arrow/Parquet; √¢ncoras Merkle di√°rias.</li>
</ul>
</li>
<li><strong>Plugins</strong> (in-proc por padr√£o; WASI/out-of-proc via QUIC quando requerido):<ul>
<li><code>exp_runner</code>, <code>exp_ingest</code>, <code>vcx_worker</code>, <code>hdl_codegen</code>, <code>hdl_sim</code>, <code>op_llm_json</code>, <code>op_rag</code>, <code>notify</code>.</li>
</ul>
</li>
</ul>
<h3 id="32-fluxo-de-alto-nivel">3.2 Fluxo de alto n√≠vel</h3>
<ol>
<li>Cliente envia <code>WorkUnit&lt;T&gt;</code> ‚Üí API valida schema/idempot√™ncia ‚Üí <strong>accepted</strong>.</li>
<li>Scheduler aplica policies ‚Üí enfileira ‚Üí adquire lease ‚Üí despacha handler (plugin).</li>
<li>Handler emite <strong>progress</strong> (tempos por etapa), produz artefatos (VCX-PACK), retorna <strong>result</strong>.</li>
<li>Servi√ßo gera <strong>Receipt</strong> (hashes, trace, tempos), <strong>assina</strong> e ancora (Merkle opcional).</li>
<li>Cliente acompanha por stream e consulta recibos via <code>/v1/receipts/{cid}</code>.</li>
</ol>
<hr />
<h2 id="4-contratos-de-dados">4) Contratos de dados</h2>
<h3 id="41-tipos-principais-rust-json-schema">4.1 Tipos principais (Rust ‚Üí JSON Schema)</h3>
<ul>
<li><code>WorkUnit&lt;T&gt;</code>; <code>WorkResult&lt;R&gt;</code>; <code>Receipt</code>; <code>Metrics</code>; <code>Signature</code>; <code>PolicyEntry</code>; <code>ArtifactRef</code>.</li>
<li><strong>NRF/CID</strong>: <code>cid = blake3(canonical_json(value))</code>.</li>
<li><strong>Idempot√™ncia</strong>: <code>(tenant, topic, idem_key)</code>; se ausente, <code>idem_key = blake3(payload_canon)</code>.</li>
</ul>
<h3 id="42-versionamento-e-interoperabilidade">4.2 Versionamento e interoperabilidade</h3>
<ul>
<li><code>@type</code>, <code>@id (uuid)</code>, <code>@ver</code>, <code>@world</code>.</li>
<li><code>schema_id</code>/<code>schema_v</code> gravados no recibo; <strong>semver estrito</strong>; Schemas publicados pelo servi√ßo.</li>
</ul>
<hr />
<h2 id="5-api-e-protocolo">5) API e protocolo</h2>
<h3 id="51-http3-quic-e-sse">5.1 HTTP/3 (QUIC) e SSE</h3>
<ul>
<li><code>POST /v1/work</code> ‚Üí enfileira <code>WorkUnit&lt;T&gt;</code>; responde <code>{status, receipt_cid}</code>.</li>
<li><code>GET /v1/stream?topic=...&amp;tenant=...&amp;id=...</code> (SSE) ‚Üí eventos <code>accepted|assigned|progress|done|error</code>.</li>
<li><code>GET /v1/receipts/{cid}</code> ‚Üí <code>Receipt</code>.</li>
<li><code>GET /v1/schema/{schema_id}/{v}</code> ‚Üí JSON Schema.</li>
<li><code>POST /v1/verify/pack</code> ‚Üí valida VCX-PACK (hashes/manifest/entries).</li>
<li><code>GET /v1/metrics</code> (Prometheus).</li>
<li><code>POST /v1/export?format=parquet|arrow</code> ‚Üí dump incremental.</li>
</ul>
<h3 id="52-quic-workersout-of-proc">5.2 QUIC (workers/out-of-proc)</h3>
<p>Frames (bidi stream):</p>
<ul>
<li><code>worker.hello{worker_id, capacity, capabilities[]}</code></li>
<li><code>job.assign{work_unit}</code> / <code>job.progress{stage, t_ms}</code> / <code>job.result{result}</code> / <code>job.fail{err}</code></li>
<li><code>job.heartbeat{lease_id}</code></li>
</ul>
<p>Leases:</p>
<ul>
<li>Tabelas <code>ready(topic)</code>, <code>leased(topic)</code> com <code>lease_ttl_ms</code>. Reassign em expira√ß√£o.</li>
</ul>
<hr />
<h2 id="6-policies-compile-time-auditaveis">6) Policies (compile-time, audit√°veis)</h2>
<p>Trait:</p>
<pre><code class="language-rust">pub trait Policy {
  fn evaluate(&amp;self, work: &amp;WorkUnit&lt;serde_json::Value&gt;) -&gt; Decision;
}
pub struct Decision { pub route: Route, pub budgets: Quotas, pub trace: Vec&lt;PolicyEntry&gt; }
</code></pre>
<p>Exemplos:</p>
<ul>
<li><code>quotas_chat</code>: <code>topic.starts_with("chat:")</code> ‚Üí <code>tokens&lt;=4000</code>.</li>
<li><code>pii_local</code>: <code>pii_detected(payload)</code> ‚Üí <code>route(LocalOnly)</code>.</li>
<li><code>commitment</code>: <code>topic.ends_with(":commit")</code> ‚Üí <code>require(DUAL_CONTROL)</code>.</li>
</ul>
<p><code>policy_trace</code> sempre gravado em <code>Receipt</code>.</p>
<hr />
<h2 id="7-vcx-pack-artefatos">7) VCX-PACK (artefatos)</h2>
<ul>
<li><strong>Formato</strong>: manifesto + √≠ndice + trailer; entradas com <code>path</code>, <code>sha</code>, <code>size</code>.</li>
<li><strong>CID do pack</strong>: <code>blake3(manifest_json)</code>.</li>
<li><strong>Lifecycle integrado</strong>: runtime exp√µe <code>pack_begin/pack_add/pack_close</code> e preenche <code>receipt.artifacts[]</code>.</li>
<li><strong>Verify</strong>: endpoint/CLI valida offsets, hashes e consist√™ncia.</li>
</ul>
<hr />
<h2 id="8-determinismo-e-reprodutibilidade">8) Determinismo e reprodutibilidade</h2>
<ul>
<li>Seeds fixos, TZ=UTC, rel√≥gios simulados quando necess√°rio.</li>
<li>Canonical JSON p/ hashing e idempot√™ncia.</li>
<li><strong>KATs</strong>: ingest/compare outputs com packs de refer√™ncia.</li>
<li>Isolamento de rede (policies) e vers√µes travadas de libs.</li>
</ul>
<hr />
<h2 id="9-observabilidade-e-forense">9) Observabilidade e forense</h2>
<ul>
<li>M√©tricas: <code>ttft_ms</code>, <code>ttr_ms</code>, <code>queue_depth</code>, <code>reassigns</code>, <code>error_rate</code>, <code>stage_time_ms{stage}</code>.</li>
<li>Exports Parquet/Arrow + DataFusion para an√°lises.</li>
<li><strong>√Çncoras Merkle di√°rias</strong> dos recibos (root publicado em log/arquivo).</li>
</ul>
<hr />
<h2 id="10-ui-pwa-axum-leptos">10) UI PWA (Axum + Leptos)</h2>
<ul>
<li><strong>Auto-forms</strong> a partir de JSON Schema dos contratos.</li>
<li>Lista/Detalhe de Jobs e <strong>üìú Recibo</strong> com <code>policy_trace</code>, hashes, tempos, artefatos (download/verify).</li>
<li><strong>Replay</strong>: bot√£o que reenvia <code>WorkUnit</code> original (ou simula via VCX-PACK/seed).</li>
</ul>
<hr />
<h2 id="11-seguranca-e-conformidade">11) Seguran√ßa e conformidade</h2>
<ul>
<li>Assinaturas <strong>ed25519</strong> on-by-default; rota√ß√£o de chaves (<code>kid</code>).</li>
<li>Pol√≠ticas para PII/local-only e DUAL_CONTROL em t√≥picos sens√≠veis.</li>
<li>Logs rotacionados; controle de reten√ß√£o; snapshots peri√≥dicos.</li>
</ul>
<hr />
<h2 id="12-roadmap-90-dias">12) Roadmap (90 dias)</h2>
<h3 id="m1-fundacao-1-binario-d0d15">M1 ‚Äî Funda√ß√£o 1-bin√°rio (D0‚ÄìD15)</h3>
<ul>
<li><code>aurea serve</code> (HTTP/3+SSE), redb, fila/leases, idempot√™ncia por hash, schemas publicados, UI base.</li>
</ul>
<h3 id="m2-recibos-fortes-vcx-d16d35">M2 ‚Äî Recibos fortes + VCX (D16‚ÄìD35)</h3>
<ul>
<li>Assinatura ed25519; tempos por etapa; VCX-PACK integrado + verify; UI ‚Äúüìú Recibo‚Äù.</li>
</ul>
<h3 id="m3-dominios-d36d65">M3 ‚Äî Dom√≠nios (D36‚ÄìD65)</h3>
<ul>
<li><code>exp_runner</code>/<code>exp_ingest</code> (WASI/bin) + KATs;</li>
<li><code>vcx_worker</code> (resize‚ÜíAV1‚Üípack) com tempos;</li>
<li><code>hdl_codegen</code>/<code>hdl_sim</code> (VCD, asserts) e packs.</li>
</ul>
<h3 id="m4-operacao-critica-e-sre-d66d90">M4 ‚Äî Opera√ß√£o cr√≠tica e SRE (D66‚ÄìD90)</h3>
<ul>
<li>Policies duras (PII/local-only, DUAL_CONTROL, janelas);</li>
<li>M√©tricas Prometheus, exports Parquet/Arrow; caos/staging; √¢ncoras Merkle.</li>
</ul>
<hr />
<h2 id="13-criterios-de-aceite">13) Crit√©rios de aceite</h2>
<ul>
<li><strong>Determinismo (Ci√™ncia/HDL)</strong>: replay reproduz artefatos byte-a-byte (hashes id√™nticos).</li>
<li><strong>VCX</strong>: pipelines com tempos por etapa no recibo; <code>verify()</code> OK do pack.</li>
<li><strong>Sem√¢nticos</strong>: Text‚ÜíJSON v√°lido no 1¬∫ ou 2¬∫ reparo; schema registrado no recibo.</li>
<li><strong>Opera√ß√£o cr√≠tica</strong>: SLOs (TTFT p95 ‚â§ 4s; TTR p95 ‚â§ 9s); reassign no lease expirado; DUAL_CONTROL efetivo.</li>
<li><strong>UI</strong>: PWA instal√°vel; stream est√°vel; ‚Äúüìú Recibo‚Äù completo.</li>
<li><strong>Assinaturas</strong>: todos recibos assinados; rota√ß√£o de <code>kid</code> valid√°vel.</li>
</ul>
<hr />
<h2 id="14-riscos-mitigacoes">14) Riscos &amp; mitiga√ß√µes</h2>
<ul>
<li><strong>AV1 CPU</strong>: presets ajust√°veis; kernels wgpu para filtros; paraleliza√ß√£o por GOP.</li>
<li><strong>Determinismo de libs</strong>: trave de vers√µes; seeds; KATs regulares; modo ‚Äúno network‚Äù.</li>
<li><strong>QUIC atr√°s de proxies</strong>: fallback WS/443; keep-alive agressivo.</li>
<li><strong>Crescimento de estado</strong>: reten√ß√£o configur√°vel; snapshots Parquet/Arrow; √¢ncoras Merkle.</li>
</ul>
<hr />
<h2 id="15-implantacao-e-operacao">15) Implanta√ß√£o e opera√ß√£o</h2>
<ul>
<li><strong>Single binary</strong>: <code>aurea serve --db ./aurea.redb --listen 0.0.0.0:8080</code>.</li>
<li><strong>Chaves</strong>: diret√≥rio <code>keys/</code> com <code>kid</code> atual e hist√≥ricos; rota√ß√£o di√°ria/semanal.</li>
<li><strong>Config</strong>: TOML com policies, quotas, janelas e roteamento de t√≥picos.</li>
<li><strong>Backup</strong>: <code>redb</code> + snapshots de recibos/artefatos; exports peri√≥dicos Parquet/Arrow.</li>
</ul>
<hr />
<h2 id="16-testes-e-validacao">16) Testes e valida√ß√£o</h2>
<ul>
<li>Unit/integration para contratos, hashing can√¥nico, idempot√™ncia e leases.</li>
<li>KATs por dom√≠nio (ci√™ncia, VCX, HDL) com packs fixos.</li>
<li>Fuzz/proptest para HDL sob <code>feature=verify</code>.</li>
<li>Chaos em staging (lat√™ncia/falhas controladas, reassign validado).</li>
</ul>
<hr />
<h2 id="17-governanca-e-licenca">17) Governan√ßa e licen√ßa</h2>
<ul>
<li><strong>Apache-2.0</strong> para n√∫cleo e plugins oficiais.</li>
<li>Plugins privados por dom√≠nio podem viver fora (respeitando contrato).</li>
<li><strong>Semver estrito</strong>; <code>schema_id/v</code> carimbado em recibos; <strong>sem vers√µes m√°gicas</strong>.</li>
</ul>
<hr />
<h2 id="18-entregaveis">18) Entreg√°veis</h2>
<ul>
<li>Bin√°rio <code>aurea</code> (serve/worker/pack).</li>
<li>Crates: <code>core</code>, <code>storage</code>, <code>runtime</code>, <code>artifacts/vcx_pack</code>, <code>plugins/*</code>.</li>
<li>UI PWA integrada.</li>
<li>Documenta√ß√£o de API/Schema, guias de opera√ß√£o e de compliance.</li>
<li>Conjunto de KATs e packs de refer√™ncia.</li>
</ul>
<hr />
<h2 id="19-exemplo-de-contrato-e-handler">19) Exemplo de contrato e handler</h2>
<pre><code class="language-rust">// Contrato
#[derive(serde::Serialize, serde::Deserialize, schemars::JsonSchema)]
pub struct VcxSpec { pub ops: Vec&lt;VcxOp&gt; }

#[derive(serde::Serialize, serde::Deserialize, schemars::JsonSchema)]
#[serde(tag=&quot;op&quot;, rename_all=&quot;snake_case&quot;)]
pub enum VcxOp { Resize{w:u32,h:u32}, EncodeAv1{preset:u8} }

// Handler
#[work(topic=&quot;vcx:graph&quot;)]
fn vcx_graph(spec: VcxSpec, ctx: Ctx) -&gt; anyhow::Result&lt;VcxResult&gt; {
    let mut pack = ctx.pack_begin(&quot;vcx-output&quot;)?;
    let t0 = ctx.stage_start(&quot;resize&quot;);
    let img = resize(spec, ctx.inputs())?;
    ctx.stage_end(&quot;resize&quot;, t0);

    let t1 = ctx.stage_start(&quot;encode_av1&quot;);
    let av1 = encode_av1(img, spec)?;
    ctx.stage_end(&quot;encode_av1&quot;, t1);

    pack.add(&quot;out/video.ivf&quot;, &amp;av1)?;
    let pack_cid = ctx.pack_close(pack)?;
    Ok(VcxResult{ pack_cid })
}
</code></pre>
<hr />
<h2 id="20-plano-de-adocao">20) Plano de ado√ß√£o</h2>
<ol>
<li><strong>Lab piloto</strong> com ci√™ncia reprodut√≠vel e VCX simples.</li>
<li>Expandir para HDL com VCD/netlists e KATs.</li>
<li>Adicionar operadores sem√¢nticos com schemas de dom√≠nio.</li>
<li>Ativar policies duras e √¢ncoras em produ√ß√£o.</li>
</ol>
<hr />
<h3 id="pronto-para-construcao">Pronto para constru√ß√£o</h3>
<p>O esqueleto inicial j√° est√° dispon√≠vel e compil√°vel. Pr√≥xima a√ß√£o recomendada: implementar <strong>M1</strong> (idempot√™ncia por hash, leases redb, UI forms por schema) no bin√°rio √∫nico e habilitar <strong>assinatura de recibos</strong>. Isso libera fluxos reais de ci√™ncia/VCX/HDL com rastreabilidade completa.</p>
<h2 id="prompt">Prompt:</h2>
<p>Se o operador for um LLM que conversa com o humano e confirma a√ß√µes, conseguimos por mais complexidade "dentro" pra ficar com ux humana mais livre?</p>
<h2 id="response">Response:</h2>
<p>Thought for 5s</p>
<p>Sim ‚Äî d√° para ‚Äúentuchar‚Äù bastante complexidade dentro do operador e manter a UX humana leve, desde que o LLM trabalhe sob <strong>contratos e fases</strong>. Abaixo est√° o padr√£o que recomendo para o √ÅUREA.</p>
<h2 id="padrao-operador-conversacional-oc">Padr√£o: Operador Conversacional (OC)</h2>
<p>Um <strong>plugin</strong> que conversa em linguagem natural e, por baixo, produz/valida <code>WorkUnit&lt;T&gt;</code> e <code>WorkResult&lt;R&gt;</code> contra <strong>schemas</strong>. Ele faz: entender inten√ß√£o, preencher slots, planejar, simular (dry-run), pedir confirma√ß√£o e s√≥ ent√£o <strong>commit</strong>.</p>
<h3 id="fases-de-fora-parece-um-chat-por-dentro-e-uma-esteira">Fases (de fora parece ‚Äúum chat‚Äù, por dentro √© uma esteira)</h3>
<ol>
<li><strong>NL ‚Üí Inten√ß√£o + Slots</strong><ul>
<li>Extra√ß√£o para <code>ActionDraft{action_id, slots, constraints, deadline?}</code></li>
<li>Valida√ß√£o imediata via JSON Schema do dom√≠nio (reduz alucina√ß√£o).</li>
</ul>
</li>
<li><strong>Planejamento</strong><ul>
<li>Gera um <strong>DAG</strong> de opera√ß√µes (ex.: VCX ‚Üí resize‚Üíencode AV1‚Üípack).</li>
<li>Estima <strong>custos/tempos</strong> (quotas) e pol√≠ticas aplic√°veis (PII/local-only, DUAL_CONTROL, janela).</li>
</ul>
</li>
<li><strong>Dry-run / Pr√©-visualiza√ß√£o</strong><ul>
<li>Gera <strong>diff/preview</strong> do que vai acontecer: artefatos esperados, SLOs, custo estimado, impactos.</li>
<li>Produz um <code>Receipt</code> <strong>ephemeral</strong> (n√£o assinado) com <code>policy_trace</code> e or√ßamentos.</li>
</ul>
</li>
<li><strong>Confirma√ß√£o</strong><ul>
<li>O OC pede um ‚ÄúOK‚Äù expl√≠cito com <strong>frase de compromisso</strong> (ex.: <code>confirm: "DUAL_CONTROL"</code> quando o t√≥pico termina com <code>:commit</code>).</li>
<li>Idempot√™ncia por <strong>hash do plano</strong> (<code>idem_key = blake3(dag_canon)</code>).</li>
</ul>
</li>
<li><strong>Commit</strong><ul>
<li>Emite <code>WorkUnit</code> definitivo para o t√≥pico de execu√ß√£o (<code>vcx:graph</code>, <code>science:run</code>, <code>hdl:sim</code>‚Ä¶), assina recibo real, ancora (Merkle opcional).</li>
<li>Stream √∫nico: <code>accepted ‚Üí assigned ‚Üí progress{‚Ä¶} ‚Üí result|fail</code>.</li>
</ul>
</li>
<li><strong>P√≥s-execu√ß√£o</strong><ul>
<li>OC agrega o <code>Receipt</code> e links de artefatos/VCX-PACK numa mensagem final, oferecendo <strong>Replay</strong> e <strong>Rollback</strong> (se aplic√°vel).</li>
</ul>
</li>
</ol>
<blockquote>
<p>Para o usu√°rio √© ‚Äúfale o que quer ‚Üí veja um cart√£o com o plano ‚Üí confirme‚Äù. Sem formulari√µes; sem idas e vindas.</p>
</blockquote>
<hr />
<h2 id="como-isso-esconde-complexidade-com-seguranca">Como isso ‚Äúesconde‚Äù complexidade (com seguran√ßa)</h2>
<ul>
<li><strong>Schema-driven</strong>: o OC s√≥ prop√µe a√ß√µes que existem no <strong>registry de capacidades</strong> (schemas exportados pelos plugins).</li>
<li><strong>Slot-filling robusto</strong>: o LLM tenta preencher campos faltantes; se n√£o couber no schema, ele <strong>auto-repara</strong> at√© N itera√ß√µes.</li>
<li><strong>Pol√≠ticas antes da fila</strong>: <code>pii_local</code> pode reescrever o plano (trocar worker remoto por local) antes de enfileirar.</li>
<li><strong>Dois est√°gios</strong>: <code>:propose</code> (ephemeral, barato) ‚Üí <code>:commit</code> (assinado).</li>
<li><strong>Quotas expl√≠citas</strong>: o cart√£o de confirma√ß√£o sempre mostra <code>tokens/time/custos</code> e <strong>janelas</strong> (quando pode rodar).</li>
<li><strong>Idempot√™ncia por plano</strong>: repetir ‚ÄúOk, manda bala‚Äù n√£o duplica execu√ß√£o.</li>
<li><strong>Audit trail</strong>: todo racioc√≠nio externo vira <code>policy_trace</code> e m√©tricas; o racioc√≠nio interno n√£o precisa ser exposto.</li>
</ul>
<hr />
<h2 id="contratos-minimos-exemplos">Contratos m√≠nimos (exemplos)</h2>
<pre><code class="language-rust">// Pedido em linguagem natural ‚Üí rascunho de a√ß√£o
#[derive(Serialize, Deserialize, JsonSchema)]
pub struct ActionDraft {
  pub action_id: String,              // ex.: &quot;vcx.batch_transcode&quot;
  pub slots: serde_json::Value,       // j√° validado contra o schema do action_id
  pub constraints: Option&lt;serde_json::Value&gt;,
  pub deadline_utc: Option&lt;String&gt;,
}

// Plano/DAG proposto
#[derive(Serialize, Deserialize, JsonSchema)]
pub struct PlanPreview {
  pub dag: serde_json::Value,         // DAG can√¥nico (ordenado)
  pub quotas: Quotas,                  // tokens/time/compute
  pub policy_trace: Vec&lt;PolicyEntry&gt;,  // o que ser√° exigido
  pub estimated_ttft_ms: u32,
  pub estimated_ttr_ms: u32
}

// Confirma√ß√£o
#[derive(Serialize, Deserialize, JsonSchema)]
pub struct CommitRequest {
  pub plan_hash: String,               // blake3(dag_canon)
  pub confirm_phrase: Option&lt;String&gt;,  // ex.: &quot;DUAL_CONTROL&quot;
}
</code></pre>
<hr />
<h2 id="ux-no-chat-uma-timeline-zero-atrito">UX no chat (uma timeline, zero atrito)</h2>
<ul>
<li>Mensagem do humano: ‚ÄúConverte esses 20 v√≠deos pra 1080p, manda link pro time A at√© amanh√£.‚Äù</li>
<li>OC responde com um <strong>card de plano</strong>:<ul>
<li>‚ÄúVou: extrair 20 itens da pasta X ‚Üí <code>resize(1920x1080)</code> ‚Üí <code>encode_av1(preset 6)</code> ‚Üí <code>pack</code> ‚Üí <code>notify:teamA</code>.‚Äù</li>
<li>SLOs e custos previstos, janelas/policies aplicadas.</li>
<li>Bot√µes: <strong>Confirmar</strong>, <strong>Editar</strong> (abre slots), <strong>Agendar</strong>.</li>
</ul>
</li>
<li>Ao confirmar, o stream mostra progresso por etapa; no fim, aparece <strong>üìú Recibo</strong> (assinado) e <strong>Baixar VCX-PACK</strong>.</li>
</ul>
<hr />
<h2 id="exemplos-por-dominio">Exemplos por dom√≠nio</h2>
<h3 id="vcx">VCX</h3>
<p>‚ÄúPadroniza pra 1080p e AV1, manda pro time A.‚Äù<br />
‚Üí OC resolve slots (preset, CRF, FPS), verifica PII (n√£o se aplica), estima TTR, pede confirma√ß√£o, executa <code>vcx:graph</code>, anexa pack e envia <code>notify</code>.</p>
<h3 id="ciencia-reprodutivel">Ci√™ncia reprodut√≠vel</h3>
<p>‚ÄúReproduz o experimento X com seed 1337 e compara com refer√™ncia.‚Äù<br />
‚Üí OC monta <code>ExperimentSpec</code>, injeta seed, bloqueia rede se policy pedir, aciona <code>exp_runner</code>, depois <code>exp_ingest</code> (KAT). Entrega diff e recibo.</p>
<h3 id="hdl">HDL</h3>
<p>‚ÄúGera HDL do m√≥dulo Y, roda sim por 10k ciclos e me d√° VCD.‚Äù<br />
‚Üí OC monta <code>hdl_codegen</code> + <code>hdl_sim</code>, fixa TZ/clock/seed, produz pack com VCD/netlist; confirma√ß√£o inclui tempo/capacidade do worker.</p>
<hr />
<h2 id="controles-que-mantem-tudo-livre-mas-seguro">Controles que mant√™m tudo ‚Äúlivre, mas seguro‚Äù</h2>
<ul>
<li><strong>Lista branca de a√ß√µes</strong> (capabilities do registry) ‚Äî nada fora do contrato.</li>
<li><strong>Campos obrigat√≥rios</strong> sempre destacados no card; se o LLM n√£o conseguir inferir, pede s√≥ o m√≠nimo essencial.</li>
<li><strong>DUAL_CONTROL</strong> para t√≥picos <code>*:commit</code>.</li>
<li><strong>Local-only</strong> for√ßa workers locais automaticamente, sem o humano precisar saber.</li>
<li><strong>Dry-run</strong> econ√¥mico: nunca queima quota pesada antes do OK.</li>
<li><strong>Rollback/Replay</strong> direto no recibo.</li>
</ul>
<hr />
<h2 id="como-integrar-no-aurea-agora">Como integrar no √ÅUREA agora</h2>
<ol>
<li><strong>Registrar capacidades</strong>: cada plugin exp√µe <code>schema/action_id</code> via endpoint (<code>/v1/schema/index</code>).</li>
<li><strong>Criar o OC</strong> no <code>plugins/op_llm_json</code> com tr√™s traits: <code>Intent</code>, <code>Planner</code>, <code>Confirmer</code>.</li>
<li><strong>Implementar <code>:propose</code> ‚Üí <code>:commit</code></strong> como dois t√≥picos internos (o primeiro n√£o assina; o segundo assina).</li>
<li><strong>UI</strong>: componente Leptos <code>PlanCard</code> (renderiza a partir do <code>PlanPreview</code>), com bot√µes <strong>Confirmar/Editar/Agendar</strong>.</li>
<li><strong>Pol√≠ticas</strong>: hooks do OC chamam <code>policy.evaluate()</code> antes de enfileirar (aplica rota/quotas/local-only).</li>
<li><strong>Idempot√™ncia</strong>: <code>idem_key = blake3(dag_canon)</code> no <code>CommitRequest</code>.</li>
</ol>
<hr />
<h2 id="ganhos-praticos">Ganhos pr√°ticos</h2>
<ul>
<li><strong>Menos idas e vindas</strong>: o OC resolve slots, valida e s√≥ te incomoda para o ‚ÄúOK‚Äù (ou um campo cr√≠tico).</li>
<li><strong>Erros precocemente baratos</strong>: problemas aparecem no dry-run (policies, quotas, prazos).</li>
<li><strong>Risco controlado</strong>: nada roda ‚Äúde verdade‚Äù sem confirma√ß√£o, recibos s√£o assinados e audit√°veis.</li>
<li><strong>Mesma UX para tudo</strong>: VCX, ci√™ncia e HDL se comportam como ‚Äúconversas com cart√µes‚Äù.</li>
</ul>
<p>Se quiser, eu j√° adapto o <code>op_llm_json</code> do esqueleto para incluir <strong>Intent ‚Üí PlanPreview ‚Üí Commit</strong> e te deixo um exemplo real de <strong>VCX batch</strong> com card de confirma√ß√£o e idempot√™ncia por hash do plano.</p>
<h2 id="prompt_1">Prompt:</h2>
<p>Esse √© o plano! Formalizar deixando o interior tb LLM friendly</p>
<h2 id="response_1">Response:</h2>
<p>Perfeito. Abaixo est√° a <strong>Especifica√ß√£o V1 ‚Äî √ÅUREA com interior LLM-friendly</strong>, formalizando interfaces, contratos e o Operador Conversacional (OC) para que a UX seja ‚Äúfale‚Üíconfirme‚Üíexecute‚Äù, enquanto o interior continua 100% tipado, verific√°vel e seguro.</p>
<h1 id="1-principios-llm-friendly">1) Princ√≠pios LLM-friendly</h1>
<ul>
<li><strong>Tudo √© Schema</strong>: cada a√ß√£o publica JSON Schema (+ exemplos) e um ‚Äútool spec‚Äù claro para LLMs.</li>
<li><strong>Dois est√°gios</strong>: <code>:propose</code> (barato, ephemero, sem efeitos) ‚Üí <code>:commit</code> (executa, assina, ancora).</li>
<li><strong>Idempot√™ncia por plano</strong>: <code>idem_key = blake3(dag_canon)</code>. Repetir ‚ÄúOK‚Äù n√£o duplica execu√ß√£o.</li>
<li><strong>Auto-reparo limitado</strong>: OC tenta reparar JSON inv√°lido at√© <code>N=2</code> itera√ß√µes; depois pede 1 campo humano.</li>
<li><strong>Privacidade de racioc√≠nio</strong>: sem exigir cadeia de pensamento; OC retorna apenas dados estruturados + justificativas curtas.</li>
<li><strong>Pol√≠ticas antes da fila</strong>: DUAL_CONTROL/PII/local-only aplicadas no <code>:propose</code>, com tra√ßo explicativo no preview.</li>
</ul>
<h1 id="2-registro-de-capacidades-capability-registry">2) Registro de Capacidades (Capability Registry)</h1>
<p>Endpoint: <code>GET /v1/capabilities</code></p>
<pre><code class="language-json">{
  &quot;version&quot;: &quot;1.0&quot;,
  &quot;capabilities&quot;: [
    {
      &quot;action_id&quot;: &quot;vcx.batch_transcode&quot;,
      &quot;schema_id&quot;: &quot;aurea.vcx.batch_transcode&quot;,
      &quot;schema_v&quot;: 1,
      &quot;summary&quot;: &quot;Transcodifica lista de m√≠dias p/ alvo padronizado.&quot;,
      &quot;examples&quot;: [&quot;Padroniza 1080p AV1 para pasta X e notifica time A.&quot;],
      &quot;topics&quot;: { &quot;commit&quot;: &quot;vcx:graph&quot;, &quot;propose&quot;: &quot;vcx:propose&quot; }
    }
  ]
}
</code></pre>
<h1 id="3-convencoes-de-schema-json-schema-canonico">3) Conven√ß√µes de Schema (JSON Schema, can√¥nico)</h1>
<ul>
<li><strong>Campos padr√£o</strong>: <code>@type</code>, <code>@ver</code>, <code>schema_id</code>, <code>schema_v</code>.</li>
<li><strong>Enums/tags</strong>: <code>#[serde(tag="op", rename_all="snake_case")]</code> para variantes.</li>
<li><strong>Exemplos e hints</strong>: incluir <code>x-ui</code> e <code>x-llm</code> (metadados amig√°veis ao LLM).</li>
<li><strong>Canoniza√ß√£o</strong>: JSON can√¥nico para hashing (ordem est√°vel, sem floats n√£o determin√≠sticos).</li>
</ul>
<p>Exemplo (resumo) ‚Äî <code>aurea.vcx.batch_transcode@1</code>:</p>
<pre><code class="language-json">{
  &quot;$id&quot;: &quot;aurea.vcx.batch_transcode#1&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;inputs&quot;, &quot;video&quot;, &quot;notify&quot;],
  &quot;properties&quot;: {
    &quot;inputs&quot;: { &quot;type&quot;: &quot;array&quot;, &quot;items&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;format&quot;: &quot;uri&quot; }, &quot;minItems&quot;: 1,
      &quot;description&quot;: &quot;URIs ou IDs internos de m√≠dias de entrada&quot; },
    &quot;video&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;required&quot;: [&quot;width&quot;,&quot;height&quot;,&quot;codec&quot;],
      &quot;properties&quot;: {
        &quot;width&quot;: {&quot;type&quot;:&quot;integer&quot;,&quot;minimum&quot;:16}, &quot;height&quot;:{&quot;type&quot;:&quot;integer&quot;,&quot;minimum&quot;:16},
        &quot;codec&quot;: {&quot;enum&quot;: [&quot;av1&quot;]}, &quot;preset&quot;: {&quot;type&quot;:&quot;integer&quot;,&quot;minimum&quot;:0,&quot;maximum&quot;:10},
        &quot;crf&quot;: {&quot;type&quot;:&quot;integer&quot;,&quot;minimum&quot;:0,&quot;maximum&quot;:63}, &quot;fps&quot;: {&quot;type&quot;:&quot;number&quot;,&quot;minimum&quot;:1}
      },
      &quot;x-llm&quot;: { &quot;defaults&quot;: {&quot;codec&quot;:&quot;av1&quot;,&quot;preset&quot;:6,&quot;crf&quot;:28,&quot;fps&quot;:30} }
    },
    &quot;notify&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;required&quot;: [&quot;channel&quot;],
      &quot;properties&quot;: { &quot;channel&quot;:{&quot;type&quot;:&quot;string&quot;}, &quot;message&quot;:{&quot;type&quot;:&quot;string&quot;} }
    },
    &quot;deadline_utc&quot;: {&quot;type&quot;:&quot;string&quot;,&quot;format&quot;:&quot;date-time&quot;}
  }
}
</code></pre>
<h1 id="4-operador-conversacional-oc-contratos">4) Operador Conversacional (OC) ‚Äî Contratos</h1>
<h2 id="41-intencao-slots">4.1 Inten√ß√£o &amp; Slots</h2>
<pre><code class="language-json">{
  &quot;@type&quot;:&quot;aurea/intent.v1&quot;,
  &quot;action_id&quot;:&quot;vcx.batch_transcode&quot;,
  &quot;slots&quot;: { &quot;...&quot;: &quot;valores j√° validados contra o schema do action_id&quot; },
  &quot;constraints&quot;: { &quot;window&quot;:&quot;business_hours&quot;, &quot;local_only&quot;:true },
  &quot;deadline_utc&quot;:&quot;2026-02-20T17:00:00Z&quot;
}
</code></pre>
<h2 id="42-planopreview-ephemero">4.2 Plano/Preview (ephemero)</h2>
<pre><code class="language-json">{
  &quot;@type&quot;:&quot;aurea/plan_preview.v1&quot;,
  &quot;plan_hash&quot;:&quot;b3_..._abcd&quot;,
  &quot;dag&quot;: { &quot;nodes&quot;:[...], &quot;edges&quot;:[...] },      // can√¥nico
  &quot;quotas&quot;: { &quot;tokens&quot;: 0, &quot;time_ms&quot;: 540000 },
  &quot;policy_trace&quot;: [ {&quot;rule&quot;:&quot;pii_local&quot;,&quot;ok&quot;:true}, {&quot;rule&quot;:&quot;window&quot;,&quot;ok&quot;:true} ],
  &quot;estimated_ttft_ms&quot;: 800,
  &quot;estimated_ttr_ms&quot;: 300000,
  &quot;artifacts_preview&quot;:[{&quot;kind&quot;:&quot;pack&quot;,&quot;label&quot;:&quot;vcx-output&quot;,&quot;est_size&quot;:&quot;~4.2GB&quot;}],
  &quot;confirm_required&quot;: &quot;DUAL_CONTROL&quot;            // ou null
}
</code></pre>
<h2 id="43-confirmacao-commit">4.3 Confirma√ß√£o ‚Üí Commit</h2>
<pre><code class="language-json">{
  &quot;@type&quot;:&quot;aurea/commit_request.v1&quot;,
  &quot;plan_hash&quot;:&quot;b3_..._abcd&quot;,
  &quot;confirm_phrase&quot;:&quot;DUAL_CONTROL&quot;,
  &quot;idem_key&quot;:&quot;b3_..._abcd&quot;,                      // = plan_hash
  &quot;tenant&quot;:&quot;acme&quot;
}
</code></pre>
<h1 id="5-topicos-e-estados-fsm">5) T√≥picos e Estados (FSM)</h1>
<p><strong>T√≥picos</strong></p>
<ul>
<li>Proposi√ß√£o: <code>*:propose</code> (sem assinatura; guarda preview opcional com TTL curto).</li>
<li>Execu√ß√£o: <code>*:commit</code> ‚Üí enfileira em <code>vcx:graph</code>, <code>science:run</code>, <code>hdl:sim</code>, etc.</li>
</ul>
<p><strong>Estados (stream √∫nico)</strong><br />
<code>accepted ‚Üí assigned ‚Üí progress{stage,time_ms,meta?} ‚Üí result{...} | fail{error_code, details}</code></p>
<p><strong>C√≥digos de erro (curtos, operacionais)</strong></p>
<ul>
<li><code>SCHEMA_INVALID</code>, <code>SLOT_MISSING</code>, <code>POLICY_BLOCKED</code>, <code>LEASE_EXPIRED</code>, <code>WORKER_UNAVAILABLE</code>, <code>ARTIFACT_VERIFY_FAIL</code>, <code>TIME_BUDGET_EXCEEDED</code></li>
</ul>
<h1 id="6-apis-http3-sse">6) APIs (HTTP/3 + SSE)</h1>
<ul>
<li><code>GET /v1/capabilities</code> ‚Üí registry</li>
<li><code>GET /v1/schema/{schema_id}/{v}</code> ‚Üí JSON Schema</li>
<li><code>POST /v1/oc/parse_intent</code> ‚Üí <code>Intent</code> (OC interpreta NL‚Üíslots v√°lidos)</li>
<li><code>POST /v1/oc/plan_preview</code> ‚Üí <code>PlanPreview</code> (aplica policies/quotas)</li>
<li><code>POST /v1/oc/commit</code> ‚Üí <code>{status, receipt_cid}</code></li>
<li><code>GET /v1/stream?tenant=&amp;topic=&amp;id=</code> ‚Üí SSE estados</li>
<li><code>GET /v1/receipts/{cid}</code> ‚Üí <code>Receipt</code> assinado</li>
<li><code>POST /v1/verify/pack</code> ‚Üí <code>{"ok":true,"issues":[]}</code></li>
<li><code>GET /v1/metrics</code> (Prometheus) | <code>POST /v1/export?format=parquet|arrow</code></li>
</ul>
<h1 id="7-tool-spec-p-llms-funcoes-chamaveis">7) Tool Spec p/ LLMs (fun√ß√µes cham√°veis)</h1>
<h2 id="71-list_capabilities">7.1 list_capabilities</h2>
<ul>
<li><strong>input</strong>: <code>{}</code></li>
<li><strong>output</strong>: <code>{"capabilities":[{action_id,schema_id,schema_v,summary}]}</code></li>
</ul>
<h2 id="72-get_schema">7.2 get_schema</h2>
<ul>
<li><strong>input</strong>: <code>{"schema_id":"aurea.vcx.batch_transcode","schema_v":1}</code></li>
<li><strong>output</strong>: <code>JSON Schema</code></li>
</ul>
<h2 id="73-propose_plan">7.3 propose_plan</h2>
<ul>
<li><strong>input</strong>: <code>ActionDraft</code> (inten√ß√£o+slots)</li>
<li><strong>output</strong>: <code>PlanPreview</code> ou erro <code>SCHEMA_INVALID</code> com <code>repair_hints[]</code></li>
</ul>
<h2 id="74-commit_plan">7.4 commit_plan</h2>
<ul>
<li><strong>input</strong>: <code>CommitRequest</code></li>
<li><strong>output</strong>: <code>{status:"accepted", "receipt_cid":"rcpt-..."}</code></li>
</ul>
<h2 id="75-replay_from_receipt">7.5 replay_from_receipt</h2>
<ul>
<li><strong>input</strong>: <code>{"receipt_cid":"rcpt-...","override?":{}}</code></li>
<li><strong>output</strong>: <code>{status, new_receipt_cid}</code></li>
</ul>
<blockquote>
<p>Esses ‚Äútools‚Äù s√£o est√°veis para function-calling/Actions de qualquer provedor.</p>
</blockquote>
<h1 id="8-auto-reparo-e-limites">8) Auto-reparo e limites</h1>
<ul>
<li><strong>Loop de reparo</strong>: at√© <strong>2</strong> tentativas:<ol>
<li>Validar <code>slots</code> contra schema ‚Üí se falhar, gerar <code>repair_patch</code> minimal (ex.: preencher <code>preset</code>, <code>crf</code>, normalizar <code>fps</code> inteiro).</li>
<li>Se ainda inv√°lido, pedir <strong>apenas</strong> os campos faltantes numa ‚Äúmensagem curta de solicita√ß√£o‚Äù (texto curto + lista de campos).</li>
</ol>
</li>
<li><strong>Campos perigosos</strong>: bloqueados por policy (<code>local_only</code>, <code>dual_control</code>, <code>max_duration_ms</code>, <code>allowed_codecs</code>).</li>
</ul>
<h1 id="9-politicas-llm-aware">9) Pol√≠ticas (LLM-aware)</h1>
<ul>
<li>OC chama <code>policy.evaluate(Intent|Plan)</code> antes de enfileirar.</li>
<li>Exemplo de regras:<ul>
<li><code>pii_local</code>: se <code>inputs</code> apontam para espa√ßo PII, <code>route=LocalOnly</code> e <code>capabilities=["local_gpu","no_network"]</code>.</li>
<li><code>window</code>: <code>deadline_utc</code> fora da janela ‚Üí <strong>agenda</strong> (OC sugere <code>schedule_at</code>).</li>
<li><code>commitment</code>: a√ß√µes com efeitos externos exigem <code>confirm_phrase:"DUAL_CONTROL"</code>.</li>
</ul>
</li>
</ul>
<p><code>policy_trace</code> sempre vem no <code>PlanPreview</code> e no <code>Receipt</code>.</p>
<h1 id="10-recibos-e-assinaturas">10) Recibos e Assinaturas</h1>
<ul>
<li><strong>Receipt</strong> inclui: <code>work_hash</code>, <code>result_hash</code>, <code>policy_trace[]</code>, <code>ttft_ms</code>, <code>ttr_ms</code>, <code>signatures[]</code>, <code>artifacts[] (pack_cid, entries[])</code>, <code>schema_id/v</code>.</li>
<li><strong>Assinatura</strong>: ed25519 (<code>alg:"Ed25519"</code>, <code>key_id:"kid-2026-02-01"</code>, <code>sig:base64</code>).</li>
<li><strong>√Çncoras Merkle</strong>: raiz di√°ria armazenada e exposta em <code>/v1/anchors/YYYY-MM-DD</code>.</li>
</ul>
<h1 id="11-observabilidade-sre">11) Observabilidade (SRE)</h1>
<ul>
<li>M√©tricas:<ul>
<li><code>aurea_ttft_ms{topic}</code></li>
<li><code>aurea_ttr_ms{topic}</code></li>
<li><code>aurea_queue_depth{topic}</code></li>
<li><code>aurea_reassigns_total{topic}</code></li>
<li><code>aurea_error_rate{topic,error_code}</code></li>
</ul>
</li>
<li>Export: <code>/v1/export?format=parquet&amp;since=...</code> com <code>receipts</code>, <code>stages</code>, <code>artifacts</code>.</li>
</ul>
<h1 id="12-ux-chat-cartao-confirmar">12) UX (chat ‚Üí cart√£o ‚Üí confirmar)</h1>
<ul>
<li><strong>Card do Plano</strong> renderizado de <code>PlanPreview</code>:<ul>
<li>Resumo em 3 linhas, lista de etapas, <strong>custos/SLOs</strong>, <code>policy_trace</code>.</li>
<li>Bot√µes: <strong>Confirmar</strong>, <strong>Editar campos</strong> (renderizados via schema), <strong>Agendar</strong>.</li>
</ul>
</li>
<li>Confirmou? Stream mostra <code>accepted/assigned/progress/result</code> + link <strong>üìú Recibo</strong> e <strong>Baixar VCX-PACK</strong>.</li>
</ul>
<h1 id="13-exemplos-rapidos">13) Exemplos r√°pidos</h1>
<h2 id="131-requisicao-natural-oc">13.1 Requisi√ß√£o natural ‚Üí OC</h2>
<p>Usu√°rio: ‚ÄúConverte 20 v√≠deos da pasta /lab/raw para 1080p AV1 e avisa o time A. Entrega at√© amanh√£.‚Äù</p>
<p><strong>Fluxo interno:</strong></p>
<ol>
<li><code>list_capabilities</code> ‚Üí encontra <code>vcx.batch_transcode</code>.</li>
<li><code>get_schema</code> ‚Üí aplica defaults (<code>preset=6, crf=28, fps=30</code>).</li>
<li><code>propose_plan</code> ‚Üí <code>PlanPreview{plan_hash=..., policy_trace=[window:ok, pii_local:false]}</code>.</li>
<li>UI mostra card ‚Üí usu√°rio clica <strong>Confirmar</strong>.</li>
<li><code>commit_plan{plan_hash, confirm_phrase?}</code> ‚Üí <code>{status:"accepted",receipt_cid:"rcpt-..."}</code>.</li>
<li>Stream + Recibo assinado.</li>
</ol>
<h2 id="132-falta-um-slot">13.2 Falta um slot</h2>
<p>Se <code>fps</code> omitido ‚Üí OC tenta <code>30</code>. Se schema exigir inteiro e veio <code>29.97</code>, <strong>auto-repara</strong> para <code>30</code>. Ainda falhou? Pede s√≥ <code>fps</code>.</p>
<h1 id="14-roadmap-llm-friendly-incremental">14) Roadmap LLM-friendly (incremental)</h1>
<ul>
<li><strong>Fase A</strong>: publicar capabilities+schemas+examples; implementar <code>propose_plan/commit_plan</code>; UI Card.</li>
<li><strong>Fase B</strong>: reparo autom√°tico + dif de planos (explicativo) + idempot√™ncia por plano.</li>
<li><strong>Fase C</strong>: pol√≠ticas duras (DUAL_CONTROL/local-only/janelas) + anchors.</li>
<li><strong>Fase D</strong>: agents externos (CLI/mobile) usando o mesmo tool spec.</li>
</ul>
<hr />
<h2 id="entregaveis-desta-especificacao">Entreg√°veis desta especifica√ß√£o</h2>
<ol>
<li>Endpoints e modelos JSON acima implementados no <code>aurea serve</code>.</li>
<li>Registry de capacidades com schemas versionados e exemplos.</li>
<li>OC dentro de <code>plugins/op_llm_json</code> com fases: <strong>Intent ‚Üí Plan ‚Üí Commit</strong>.</li>
<li>UI Leptos com <strong>PlanCard</strong> e formul√°rios auto-gerados pelo schema.</li>
<li>Valida√ß√£o, auto-reparo (N=2), idempot√™ncia por <code>plan_hash</code>, assinatura de recibos e m√©tricas SRE.</li>
</ol>
<p>Com isso, a ‚Äúconversa‚Äù vira a interface ‚Äî e a complexidade fica dentro, contratualizada e audit√°vel, sem atrito para quem usa. Quer que eu j√° atualize o esqueleto para incluir <code>capabilities</code>, <code>oc/*</code> (endpoints), <code>PlanCard</code> e um exemplo completo de <code>vcx.batch_transcode</code>?</p>
<h2 id="prompt_2">Prompt:</h2>
<p>o plano completo s√£o as 2 mensagens √∫ltimas n√©?</p>
<h2 id="response_2">Response:</h2>
<p>Sim. O plano completo est√° nas <strong>duas √∫ltimas mensagens</strong>:</p>
<ol>
<li><strong>Padr√£o do Operador Conversacional (OC)</strong> ‚Äî como o LLM conduz inten√ß√£o ‚Üí plano ‚Üí confirma√ß√£o ‚Üí execu√ß√£o, com dry-run, idempot√™ncia por plano e pol√≠ticas aplicadas antes da fila.</li>
<li><strong>Especifica√ß√£o V1 LLM-friendly</strong> ‚Äî formaliza√ß√£o dos contratos e APIs:<ul>
<li>Registry de capacidades + JSON Schemas e metadados <code>x-llm</code>.</li>
<li>Objetos <code>Intent</code>, <code>PlanPreview</code>, <code>CommitRequest</code> e FSM de estados.</li>
<li>Endpoints (<code>/v1/oc/*</code>, schemas, receipts, metrics, export).</li>
<li>Tool spec para function-calling (list/get/propose/commit/replay).</li>
<li>Policies, assinaturas, √¢ncoras Merkle, m√©tricas SRE e UI PlanCard.</li>
<li>Roadmap de implementa√ß√£o.</li>
</ul>
</li>
</ol>
<p>Se quiser, junto tudo em um √∫nico <strong>doc Markdown</strong> (ou PDF) com √≠ndice e links entre se√ß√µes.</p>
<h2 id="prompt_3">Prompt:</h2>
<p>Fazer pesquisa ampla na internet sobre softwares que tentam a reprodutibilidade de experimentos cient√≠ficos - o que fazem, como fazem e as dores</p>
<h2 id="response_3">Response:</h2>
<p>Thought for 24s</p>
<p>Perfeito, Dan! Fiz uma varredura ampla e organizei o panorama em 6 ‚Äúfam√≠lias‚Äù de solu√ß√µes para reprodutibilidade computacional ‚Äî com exemplos, como fazem e as dores t√≠picas que relatam. No fim, deixo um mapa das principais lacunas onde o √ÅUREA pode brilhar.</p>
<h1 id="1-empacotamentocapsulas-executaveis">1) Empacotamento/c√°psulas execut√°veis</h1>
<p><strong>O que fazem:</strong> empacotam c√≥digo+ambiente+dados e (√†s vezes) resultados numa ‚Äúc√°psula‚Äù que pode ser reexecutada noutro lugar.<br />
<strong>Como fazem:</strong> tra√ßam depend√™ncias e congelam ambiente (sistemas, libs, vari√°veis) e inputs, depois geram um pacote com manifesto/proveni√™ncia; alguns d√£o DOI e hist√≥rico.<br />
<strong>Exemplos:</strong></p>
<ul>
<li><strong>ReproZip/ReproServer</strong>: captura execu√ß√µes e gera um bundle <code>.rpz</code>; reexecuta em diversos ‚Äúunpackers‚Äù (sem lock-in). <a href="https://www.reprozip.org/?utm_source=chatgpt.com">reprozip.org+2docs.libnova.com+2</a></li>
<li><strong>Code Ocean</strong>: ‚Äúcompute capsules‚Äù imut√°veis com lineage graph, versionamento, DOI/publish. <a href="https://codeocean.com/product/compute-capsules?utm_source=chatgpt.com">codeocean.com+2library.hkust.edu.hk+2</a></li>
<li><strong>Whole Tale</strong>: ‚Äútales‚Äù como objetos de pesquisa execut√°veis (dados+ambiente+c√≥digo+metadados). <a href="https://wholetale.org/?utm_source=chatgpt.com">wholetale.org+2labs.globus.org+2</a></li>
<li><strong>RO-Crate / Workflow RO-Crate</strong>: padr√£o para empacotar objetos (dados, software, workflows) com metadados FAIR e perfis para <strong>runs</strong> (proveni√™ncia de execu√ß√µes). <a href="https://www.researchobject.org/ro-crate/about_ro_crate?utm_source=chatgpt.com">researchobject.org+3researchobject.org+3RDA+3</a></li>
</ul>
<p><strong>Dores comuns:</strong> drift do ambiente com o tempo, formatos/ontologias diferentes de proveni√™ncia, dados sens√≠veis e acesso a reposit√≥rios externos. <a href="https://www.sciencedirect.com/science/article/pii/S0167739X25002195?utm_source=chatgpt.com">ScienceDirect+1</a></p>
<h1 id="2-orquestradoresworkflow-engines">2) Orquestradores/workflow engines</h1>
<p><strong>O que fazem:</strong> definem pipelines determin√≠sticos, paralelizam, escalam em HPC/cloud e <strong>integram containers</strong> para portabilidade.<br />
<strong>Como fazem:</strong> linguagens declarativas (Snakefile, Nextflow DSL, CWL), execu√ß√£o com Docker/Apptainer, caching, al√©m de cat√°logos comunit√°rios (nf-core, WorkflowHub).<br />
<strong>Exemplos:</strong></p>
<ul>
<li><strong>Snakemake</strong>: workflows declarados em Python; descrevem softwares e implantam automaticamente; documenta√ß√£o foca em portabilidade e reprodutibilidade. <a href="https://snakemake.readthedocs.io/en/stable/?utm_source=chatgpt.com">snakemake.readthedocs.io+1</a></li>
<li><strong>Nextflow</strong>: executa com Docker/Apptainer/Podman; mesma pipeline roda em qualquer Unix; integra√ß√£o com Git e nf-core. <a href="https://nextflow.io/docs/latest/container.html?utm_source=chatgpt.com">nextflow.io+1</a></li>
<li><strong>Galaxy</strong>: plataforma web multi-usu√°rio com workflows reprodut√≠veis e biblioteca p√∫blica; integra reposit√≥rios de dados (ex.: Dataverse) e fornece DOIs para workflows curados. <a href="https://academic.oup.com/nar/article/52/W1/W83/7676834?utm_source=chatgpt.com">OUP Academic+2iwc.galaxyproject.org+2</a></li>
<li><strong>WorkflowHub</strong> (registro): publica/descobre workflows com <strong>RO-Crate</strong>, CWL, TRS; promove workflows como objetos FAIR. <a href="https://workflowhub.eu/?utm_source=chatgpt.com">workflowhub.eu+2Nature+2</a></li>
</ul>
<p><strong>Dores comuns:</strong> falhas de reexecu√ß√£o autom√°tica por depend√™ncias externas, falta de padr√µes interoper√°veis de proveni√™ncia (da√≠ o avan√ßo do <strong>Workflow Run RO-Crate</strong>). <a href="https://mir.cs.illinois.edu/marinov/publications/GraysonETAL23SnakemakeNextflow.pdf?utm_source=chatgpt.com">mir.cs.illinois.edu+1</a></p>
<h1 id="3-notebooks-reproduziveis-ensinodemos">3) Notebooks reproduz√≠veis (ensino/demos)</h1>
<p><strong>O que fazem:</strong> tornam reposit√≥rios execut√°veis em um clique para ensino, revis√£o e demo.<br />
<strong>Como fazem:</strong> <strong>Binder/BinderHub</strong> constr√≥i imagens a partir de <code>environment.yml</code>/<code>requirements.txt</code>/<code>Dockerfile</code> e sobe um Jupyter ef√™mero. <a href="https://jupyter.org/binder?utm_source=chatgpt.com">jupyter.org+2mybinder.org+2</a><br />
<strong>Dores:</strong> limites de recursos/tempo, falta de GPU persistente, e depend√™ncia de arquivos de configura√ß√£o bem mantidos. <a href="https://earth-env-data-science.github.io/lectures/environment/binder.html?utm_source=chatgpt.com">earth-env-data-science.github.io</a></p>
<h1 id="4-gestao-de-dados-versoes-e-proveniencia">4) Gest√£o de dados, vers√µes e proveni√™ncia</h1>
<p><strong>O que fazem:</strong> versionam datasets e modelos, ligam execu√ß√µes a artefatos, e preservam o <strong>lineage</strong> (quem gerou o qu√™, quando e como).<br />
<strong>Como fazem:</strong> sobre Git/git-annex e/ou armazenamento de objetos; logs de execu√ß√µes; refer√™ncias imut√°veis.<br />
<strong>Exemplos:</strong></p>
<ul>
<li><strong>DataLad</strong>: versionamento de dados/cole√ß√µes, integra√ß√£o com RDM; casos de ‚Äúpaper reprodut√≠vel‚Äù. <a href="https://www.datalad.org/?utm_source=chatgpt.com">datalad.org+1</a></li>
<li><strong>DVC</strong>: extens√£o Git para dados/modelos/experimentos; pipelines reproduz√≠veis para ML. <a href="https://dvc.org/?utm_source=chatgpt.com">DVC+1</a></li>
<li><strong>MLflow</strong>: rastreia par√¢metros, m√©tricas e <strong>artefatos</strong>; registry de modelos para reexecutar/validar. <a href="https://mlflow.org/docs/latest/api_reference/python_api/mlflow.artifacts.html?utm_source=chatgpt.com">MLflow+1</a></li>
<li><strong>Pachyderm</strong>: pipelines dirigidos a dados com <strong>data versioning</strong> e lineage autom√°ticos em Kubernetes. <a href="https://github.com/pachyderm/pachyderm?utm_source=chatgpt.com">GitHub+1</a></li>
</ul>
<p><strong>Dores:</strong> custo/complexidade de hospedar infra, GC de dados grandes, pol√≠ticas de acesso/PII; necessidade de ‚Äúglue‚Äù para ligar dados‚Üîworkflow‚Üîrecibos verific√°veis. <a href="https://atlan.com/pachyderm-data-lineage/?utm_source=chatgpt.com">Atlan+1</a></p>
<h1 id="5-portais-de-compartilhamentodoi-e-open-science">5) Portais de compartilhamento/DOI e open science</h1>
<p><strong>O que fazem:</strong> providenciam dep√≥sito/DOI para dados, c√≥digo, c√°psulas e materiais; melhoram cita√ß√£o e descoberta.<br />
<strong>Exemplos:</strong> <strong>OSF</strong> (gest√£o do ciclo de pesquisa, preregistro, integra GitHub/Drive); <strong>Figshare</strong> (reposit√≥rio com DOI). <a href="https://www.cos.io/products/osf?utm_source=chatgpt.com">cos.io+2Current Protocols+2</a></p>
<p><strong>Dores:</strong> pol√≠ticas desiguais entre peri√≥dicos, pouca padroniza√ß√£o de ‚Äúo que conta‚Äù como material reproduz√≠vel. <a href="https://www.frontiersin.org/journals/computer-science/articles/10.3389/fcomp.2024.1491823/full?utm_source=chatgpt.com">Frontiers</a></p>
<h1 id="6-padroes-de-metadados-e-praticas">6) Padr√µes de metadados e pr√°ticas</h1>
<p><strong>O que fazem:</strong> definem boas pr√°ticas e padr√µes para tornar pacotes/workflows <strong>FAIR</strong> e reproduz√≠veis (PROV, RO-Crate, ‚ÄúTen Simple Rules‚Äù).<br />
<strong>Refer√™ncias √∫teis:</strong> guias e revis√µes listando barreiras (ambiente, dados restritos, cultura e treino) e recomenda√ß√µes. <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371%2Fjournal.pcbi.1003285&amp;utm_source=chatgpt.com">PLOS+2PLOS+2</a></p>
<hr />
<h2 id="padroes-de-como-recorrentes-nos-projetos">Padr√µes de ‚Äúcomo‚Äù (recorrentes nos projetos)</h2>
<ol>
<li><strong>Containeriza√ß√£o + pin de vers√µes</strong> (Docker/Apptainer) p/ isolar depend√™ncias. <a href="https://nextflow.io/docs/latest/container.html?utm_source=chatgpt.com">nextflow.io+1</a></li>
<li><strong>Proveni√™ncia de execu√ß√£o</strong> (graph/lineage, RO-Crate para runs). <a href="https://codeocean.com/product/compute-capsules?utm_source=chatgpt.com">codeocean.com+1</a></li>
<li><strong>Empacotes cit√°veis</strong> com manifesto + DOI (capsule/tale/RO-Crate). <a href="https://wholetale.org/?utm_source=chatgpt.com">wholetale.org+1</a></li>
<li><strong>Registries</strong> de workflows (descoberta, vers√µes, testes cont√≠nuos). <a href="https://iwc.galaxyproject.org/about/?utm_source=chatgpt.com">iwc.galaxyproject.org</a></li>
<li><strong>Versionamento de dados/modelos</strong> e amarra√ß√£o aos jobs. <a href="https://www.datalad.org/?utm_source=chatgpt.com">datalad.org+1</a></li>
</ol>
<hr />
<h2 id="dores-estruturais-sintese">Dores estruturais (s√≠ntese)</h2>
<ul>
<li><strong>Drift e envelhecimento</strong>: ambientes e imagens se tornam irreprodut√≠veis com o tempo; necessidade de ‚Äúreceipts‚Äù verific√°veis e √¢ncoras. <a href="https://mir.cs.illinois.edu/marinov/publications/GraysonETAL23SnakemakeNextflow.pdf?utm_source=chatgpt.com">mir.cs.illinois.edu</a></li>
<li><strong>Dados e acesso</strong>: PII, dados propriet√°rios e reposit√≥rios privados quebram demos p√∫blicas; solu√ß√µes integram uploads diretos e trilhas audit√°veis. <a href="https://galaxyproject.org/news/2026-01-15-dataverse/?utm_source=chatgpt.com">galaxyproject.org</a></li>
<li><strong>Interoperabilidade de proveni√™ncia</strong>: m√∫ltiplos formatos; RO-Crate Run surge para padronizar ‚Äúexecu√ß√£o‚Äù. <a href="https://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0309210&amp;utm_source=chatgpt.com">PLOS</a></li>
<li><strong>Custo/infra</strong>: operar clusters/containers/registries e armazenar vers√µes √© caro; GC e pol√≠ticas de reten√ß√£o s√£o essenciais. <a href="https://atlan.com/pachyderm-data-lineage/?utm_source=chatgpt.com">Atlan</a></li>
<li><strong>Cultura e pol√≠tica editorial</strong>: varia√ß√£o grande nas exig√™ncias de reprodutibilidade e pouco reconhecimento formal para software/dados. <a href="https://www.frontiersin.org/journals/computer-science/articles/10.3389/fcomp.2024.1491823/full?utm_source=chatgpt.com">Frontiers</a></li>
<li><strong>GPU/aleatoriedade</strong>: determinismo em ML/AV1/HDL exige seeds, fixar clocks/TZ, desabilitar rede quando necess√°rio (pr√°ticas, n√£o s√≥ ferramentas). <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371%2Fjournal.pcbi.1003285&amp;utm_source=chatgpt.com">PLOS</a></li>
</ul>
<hr />
<h2 id="onde-o-aurea-se-encaixa-oportunidades">Onde o √ÅUREA se encaixa (oportunidades)</h2>
<ul>
<li><strong>Recibos fortes</strong>: muitos projetos t√™m metadata/lineage, poucos entregam <strong>receipts assinados</strong> com hashes de entrada/sa√≠da e pol√≠tica aplicada ‚Äî lacuna que o √ÅUREA cobre nativamente. <a href="https://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0309210&amp;utm_source=chatgpt.com">PLOS</a></li>
<li><strong>Idempot√™ncia por plano</strong> + <strong>DUAL_CONTROL/local-only</strong> antes da fila: raramente √© 1¬™ classe fora de dom√≠nios regulados. <a href="https://www.frontiersin.org/journals/computer-science/articles/10.3389/fcomp.2024.1491823/full?utm_source=chatgpt.com">Frontiers</a></li>
<li><strong>Pacote universal de artefatos (VCX-PACK) + RO-Crate</strong>: interoperar com RO-Crate/WorkflowHub mantendo benef√≠cios de empacote bin√°rio eficiente. <a href="https://www.researchobject.org/workflow-run-crate/?utm_source=chatgpt.com">researchobject.org</a></li>
<li><strong>UI conversacional com dry-run</strong>: grande parte das plataformas exige formulari√µes; o padr√£o OC do √ÅUREA reduz atrito sem perder contrato. (Contexto comparado a Code Ocean ‚Äúpreview‚Äù e Galaxy ‚Äúhistory/workflow tests‚Äù.) <a href="https://codeocean.com/product/compute-capsules?utm_source=chatgpt.com">codeocean.com+1</a></li>
</ul>
<hr />
<h2 id="lista-curta-de-ferramentas-por-uso">Lista curta de ferramentas (por uso)</h2>
<ul>
<li><strong>C√°psulas/empacote:</strong> ReproZip; Code Ocean; Whole Tale; RO-Crate/Workflow RO-Crate. <a href="https://www.reprozip.org/?utm_source=chatgpt.com">ScienceInsights+3reprozip.org+3codeocean.com+3</a></li>
<li><strong>Workflows:</strong> Snakemake; Nextflow; Galaxy; CWL (via WorkflowHub). <a href="https://snakemake.readthedocs.io/en/stable/?utm_source=chatgpt.com">workflowhub.eu+3snakemake.readthedocs.io+3nextflow.io+3</a></li>
<li><strong>Dados/linhagem:</strong> DataLad; DVC; MLflow; Pachyderm. <a href="https://www.datalad.org/?utm_source=chatgpt.com">GitHub+3datalad.org+3DVC+3</a></li>
<li><strong>Notebooks:</strong> Binder/BinderHub. <a href="https://jupyter.org/binder?utm_source=chatgpt.com">jupyter.org</a></li>
<li><strong>Open science/DOI:</strong> OSF; Figshare. <a href="https://www.cos.io/products/osf?utm_source=chatgpt.com">cos.io+1</a></li>
</ul>
<p>Se quiser, converto isso num <strong>doc comparativo</strong> (tabelado) com crit√©rios (empacote, workflows, proveni√™ncia, DOI, containers, GPU, PII, pol√≠ticas), marcando onde cada um √© forte/fraco e adiciono recomenda√ß√µes de interoperabilidade direta com o √ÅUREA (ex.: export de <strong>Workflow Run RO-Crate</strong> junto do <strong>Receipt</strong>).</p>
<h2 id="prompt_4">Prompt:</h2>
<p>O que √© importante incorporar</p>
<h2 id="response_4">Response:</h2>
<p>Perfeito ‚Äî aqui vai o que <strong>vale incorporar j√°</strong> no √ÅUREA para ficar s√≥lido, interoper√°vel e com UX leve, sem perder for√ßa t√©cnica.</p>
<h2 id="1-padroes-e-interoperabilidade-sem-lock-in">1) Padr√µes e interoperabilidade (sem lock-in)</h2>
<ul>
<li><strong>Export/Import RO-Crate (incl. Workflow Run RO-Crate)</strong> junto do <strong>Receipt</strong>: mant√©m FAIR/descoberta e facilita publica√ß√£o/DOI.</li>
<li><strong>Mapeamento VCX-PACK ‚Üî RO-Crate</strong>: manifesto ‚Üí <code>ro-crate-metadata.json</code>, <code>entries[]</code> ‚Üí <code>hasPart[]</code>; incluir <code>provenance/activity</code>.</li>
<li><strong>JSON Schema + ‚Äútool spec‚Äù</strong> por a√ß√£o: <code>schema_id/v</code>, exemplos, <code>x-llm</code> (defaults/hints), <code>x-ui</code> (widget/sem√¢ntica).</li>
<li><strong>CWL/Snakemake/Nextflow adapters (leitura)</strong>: importar um pipeline e convert√™-lo para DAG tipado do √ÅUREA (mesmo que com perda m√≠nima).</li>
</ul>
<h2 id="2-determinismo-e-proveniencia-by-default">2) Determinismo e proveni√™ncia ‚Äúby default‚Äù</h2>
<ul>
<li><strong>Canonical JSON</strong> para hashing (NRF/CID) e idempot√™ncia por plano (hash do DAG).</li>
<li><strong>Seeds/TZ/clock fixos</strong> e <strong>‚Äúno network‚Äù</strong> opcional por policy; registrar <strong>hardware/runtime fingerprint</strong> (CPU/GPU, driver, libc).</li>
<li><strong>Merkle di√°rio</strong> para recibos (root publicado); todas execu√ß√µes com <strong>assinatura ed25519</strong> e <code>kid</code> rotativo.</li>
<li><strong>KATs cont√≠nuos</strong>: toda a√ß√£o cr√≠tica tem <code>exp_ingest</code>/comparador oficial (bit-a-bit para ci√™ncia/HDL; toler√¢ncias documentadas para m√≠dia/ML).</li>
</ul>
<h2 id="3-politica-e-seguranca-antes-da-fila">3) Pol√≠tica e seguran√ßa antes da fila</h2>
<ul>
<li><strong>Avalia√ß√£o de policy no <code>:propose</code></strong> (n√£o no <code>:commit</code>): <code>local-only/PII</code>, janelas, cotas e DUAL_CONTROL j√° aparecem no <strong>PlanCard</strong>.</li>
<li><strong>DUAL_CONTROL</strong> com frase de compromisso e carimbo no recibo; <strong>rastreabilidade</strong> do aprovador no <code>policy_trace</code>.</li>
<li><strong>Rotas autom√°ticas</strong>: se PII ou segredo ‚Üí for√ßa <strong>worker local</strong>; se janela restrita ‚Üí <strong>agenda</strong> em vez de falhar.</li>
</ul>
<h2 id="4-dados-e-artefatos-como-1a-classe">4) Dados e artefatos como 1¬™ classe</h2>
<ul>
<li><strong>Integra√ß√£o opcional com DVC/DataLad</strong>: gravar no <code>Receipt</code> a refer√™ncia imut√°vel do dataset/modelo (hash/URL).</li>
<li><strong><code>verify()</code> nativo do VCX-PACK</strong> + valida√ß√£o de offsets/hashes; <strong>policy de reten√ß√£o</strong> e <strong>GC</strong> para packs grandes.</li>
<li><strong>Cat√°logo de artefatos</strong> consult√°vel (por <code>pack_cid</code>, <code>schema_id</code>, tags), com <strong>linhagem</strong> (quem/qual recibo gerou).</li>
</ul>
<h2 id="5-execucao-e-orquestracao-simplificadas">5) Execu√ß√£o e orquestra√ß√£o simplificadas</h2>
<ul>
<li><strong>Um bin√°rio (<code>aurea</code>)</strong>: API+UI+fila/leases+assinaturas+metrics; workers <strong>in-proc</strong> por padr√£o, QUIC/out-of-proc quando isolar.</li>
<li><strong>Leases no redb</strong> com reassign autom√°tico; idempot√™ncia <code>(tenant, topic, idem_key)</code> preenchida por hash do plano se ausente.</li>
<li><strong>Estados padronizados</strong> num stream: <code>accepted ‚Üí assigned ‚Üí progress{stage} ‚Üí result|fail{code}</code> com <strong>tempos por etapa</strong>.</li>
</ul>
<h2 id="6-operador-conversacional-llm-com-contratos">6) Operador Conversacional (LLM) com contratos</h2>
<ul>
<li><strong>Duas etapas</strong>: <code>:propose</code> ‚Üí <strong>PlanCard</strong> (DAG, SLOs, custos, policy_trace) ‚Üí <strong>Confirmar</strong> ‚Üí <code>:commit</code>.</li>
<li><strong>Auto-reparo N=2</strong> para slots; se falhar, pedir <strong>s√≥</strong> os campos faltantes (lista curta).</li>
<li><strong>Idempot√™ncia por plano</strong>: <code>idem_key = blake3(dag_canon)</code>; repetir ‚ÄúOK‚Äù n√£o duplica.</li>
</ul>
<h2 id="7-observabilidade-e-slos-operacionais">7) Observabilidade e SLOs operacionais</h2>
<ul>
<li><strong>M√©tricas SRE</strong>: <code>ttft_ms</code>, <code>ttr_ms</code>, <code>queue_depth</code>, <code>reassigns</code>, <code>error_rate{code}</code>, <code>stage_time_ms{stage}</code>.</li>
<li><strong>Exports Arrow/Parquet</strong> e consultas DataFusion; <strong>amostras de recibos</strong> para auditoria.</li>
<li><strong>Or√ßamentos em tempo real</strong>: mostrar no PlanCard e emitir alerta quando excedidos.</li>
</ul>
<h2 id="8-publicacao-e-citabilidade">8) Publica√ß√£o e citabilidade</h2>
<ul>
<li><strong>DOI opcional</strong> para packs/execu√ß√µes (integra√ß√£o OSF/Figshare/Zenodo) via bot√£o ‚ÄúPublicar‚Äù no recibo.</li>
<li><strong>Manifesto de cita√ß√£o</strong> (CITATION.cff/RO-Crate) gerado automaticamente com autores, vers√£o e <code>receipt_cid</code>.</li>
</ul>
<h2 id="9-testes-ci-e-hardening">9) Testes, CI e hardening</h2>
<ul>
<li><strong>Testes de determinismo</strong> por dom√≠nio (ci√™ncia/HDL bit-a-bit; m√≠dia com thresholds fixos).</li>
<li><strong>Chaos/staging</strong> com lat√™ncia/falha/kill para validar reassign e SLOs.</li>
<li><strong>Compatibilidade GPU</strong>: lista de vers√µes/flags que garantem determinismo (ex.: desativar kernels n√£o determin√≠sticos quando exigido).</li>
</ul>
<hr />
<h1 id="prioridade-pratica-o-que-entrar-agora">Prioridade pr√°tica (o que entrar agora)</h1>
<h3 id="p0-base-impossivel-de-quebrar">P0 ‚Äî Base ‚Äúimposs√≠vel de quebrar‚Äù</h3>
<ol>
<li><strong>Assinatura de recibos + Merkle di√°rio</strong></li>
<li><strong>Canonical JSON + idempot√™ncia por plano</strong></li>
<li><strong>Policy no <code>:propose</code> + DUAL_CONTROL</strong></li>
<li><strong>Verifica√ß√£o VCX-PACK (<code>verify()</code>)</strong></li>
<li><strong>PlanCard com SLOs/custos/policy_trace</strong></li>
</ol>
<h3 id="p1-interop-e-dados">P1 ‚Äî Interop e dados</h3>
<ol>
<li><strong>Export RO-Crate (incl. Run)</strong> junto do Receipt</li>
<li><strong>Refer√™ncias DVC/DataLad no recibo</strong></li>
<li><strong>Adapters de leitura de CWL/Snakemake ‚Üí DAG √ÅUREA</strong></li>
</ol>
<h3 id="p2-operacao-e-sre">P2 ‚Äî Opera√ß√£o e SRE</h3>
<ol>
<li><strong>M√©tricas SRE completas + exports Parquet</strong></li>
<li><strong>Chaos/staging + testes de determinismo automatizados</strong></li>
</ol>
<hr />
<h2 id="onde-encaixa-no-monorepo">Onde encaixa no monorepo</h2>
<ul>
<li><code>core/</code>: canonical JSON, tipos <code>Intent/PlanPreview/CommitRequest</code>.</li>
<li><code>receipts/</code> (ou dentro do bin√°rio): assinatura, Merkle, <code>verify()</code> de assinatura.</li>
<li><code>artifacts/vcx_pack/</code>: <code>verify()</code>, mapeamento para RO-Crate.</li>
<li><code>runtime/</code>: leases, tempos por etapa, roteamento por <code>topic</code>.</li>
<li><code>plugins/op_llm_json/</code>: <code>:propose ‚Üí PlanCard ‚Üí :commit</code> com auto-reparo.</li>
<li><code>ui_web/</code>: <strong>PlanCard</strong> + ‚Äúüìú Recibo‚Äù com download/verify/export/DOI.</li>
<li><code>bus/</code> (ou <code>aurea</code>): endpoints <code>/v1/capabilities</code>, <code>/v1/oc/*</code>, <code>/v1/export</code>, <code>/v1/anchors/*</code>.</li>
</ul>
<hr />
<h2 id="aceite-minimo-para-cada-item">Aceite m√≠nimo para cada item</h2>
<ul>
<li><strong>Recibo assinado</strong>: <code>signatures[].alg=Ed25519</code>, <code>kid</code> v√°lido, <code>verify_receipt()</code> retorna OK.</li>
<li><strong>Merkle</strong>: <code>anchors/YYYY-MM-DD.json</code> com root e lista de <code>receipt_cid</code>.</li>
<li><strong>PlanCard</strong>: mostra <code>policy_trace</code>, SLOs (TTFT/TTR), custos e <strong>Confirmar/Agendar/Editar</strong>.</li>
<li><strong>RO-Crate</strong>: arquivo <code>ro-crate-metadata.json</code> alinhado ao pack; <code>run</code> presente quando houver execu√ß√£o.</li>
<li><strong>Determinismo</strong>: replays do mesmo recibo geram <strong>hash(es) id√™nticos</strong> (ou dentro do tolerance configurado/registrado).</li>
</ul>
<p>Se topar, j√° abro os √©picos: <strong>P0-Assinaturas+Merkle</strong>, <strong>P0-Canonical+Idempot√™ncia</strong>, <strong>P0-Policy-Propose+DUAL_CONTROL</strong>, <strong>P0-PlanCard</strong>, <strong>P0-VCX-PACK Verify</strong> ‚Äî e deixo os contratos/rotas prontos para o OC e para o export RO-Crate.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-right" title="Home">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href=".." style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
